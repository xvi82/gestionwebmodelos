var datePickerController=function datePickerController(){function affectJSON(e){if("object"==typeof e)for(key in e)switch(value=e[key],key.toLowerCase()){case"lang":-1!=value.search(/^[a-z]{2}$/i)&&(languageInfo=value,returnLocaleDate=!0);break;case"split":"object"==typeof value&&value.length&&2==value.length&&(splitAppend=value);break;case"formats":if("object"==typeof value&&value.length){for(var t,a=[],s=0;t=value[s];s++)t.match(/((sp|dt|sl|ds|cc)|([d|D|l|j|N|w|S|W|M|F|m|n|t|Y|o|y|O|p]))(-((sp|dt|sl|ds|cc)|([d|D|l|j|N|w|S|W|M|F|m|n|t|Y|o|y|O|p])))+/)&&a.push(t);a.length&&(formatMasks=a)}break;case"nodrag":nodrag=!!value;break;case"buttontabindex":buttonTabIndex=!!value;break;case"cellformat":"string"==typeof value&&value.match(/^((sp|dt|sl|ds|cc)|([d|D|l|j|N|w|S|W|M|F|m|n|t|Y|o|y|O|p]))(-((sp|dt|sl|ds|cc)|([d|D|l|j|N|w|S|W|M|F|m|n|t|Y|o|y|O|p])))+$/)&&parseCellFormat(value);break;case"titleformat":value.match(/((sp|dt|sl|ds|cc)|([d|D|l|j|N|w|S|W|M|F|m|n|t|Y|o|y|O|p]))(-((sp|dt|sl|ds|cc)|([d|D|l|j|N|w|S|W|M|F|m|n|t|Y|o|y|O|p])))+/)&&(titleFormat=value)}}function parseCellFormat(e){for(var t,a=e.split("-"),s=[],i=[],n=0;n<a.length;n++)t=a[n],"j"==t||"d"==t?(i.length&&(s.push(i.join("-")),i=[]),s.push("placeholder")):i.push(t);return i.length&&s.push(i.join("-")),!s.length||s.length>3?(formatParts=window.opera?["placeholder"]:["placeholder","sp-F-sp-Y"],void(cellFormat="j-sp-F-sp-Y")):(formatParts=window.opera?["placeholder"]:s,void(cellFormat=window.opera?"j-sp-F-sp-Y":e))}function pad(e,t){return t=t||2,"0000".substr(0,t-Math.min(String(e).length,t))+e}function addEvent(e,t,a){try{e.attachEvent?(e["e"+t+a]=a,e[t+a]=function(){e["e"+t+a](window.event)},e.attachEvent("on"+t,e[t+a])):e.addEventListener(t,a,!0)}catch(s){alert(e+" "+t+" "+a)}}function removeEvent(e,t,a){try{e.detachEvent?(e.detachEvent("on"+t,e[t+a]),e[t+a]=null):e.removeEventListener(t,a,!0)}catch(s){}}function stopEvent(e){return e=e||document.parentWindow.event,e.stopPropagation&&(e.stopPropagation(),e.preventDefault()),!1}function parseJSON(e){if("string"!=typeof e||""==e)return{};try{if("JSON"in window&&"parse"in window.JSON&&"function"==typeof window.JSON.parse)return window.JSON.parse(e);if(/lang|split|formats|nodrag/.test(e.toLowerCase())){var t=Function(["var document,top,self,window,parent,Number,Date,Object,Function,","Array,String,Math,RegExp,Image,ActiveXObject;","return (",e.replace(/<\!--.+-->/gim,"").replace(/\bfunction\b/g,"function�"),");"].join(""));return t()}}catch(a){}return{err:"Trouble parsing JSON object"}}function setARIARole(e,t){e&&e.tagName&&e.setAttribute("role",t)}function setARIAProperty(e,t,a){e&&e.tagName&&e.setAttribute("aria-"+t,a)}function datePicker(e){this.dateSet=null,this.timerSet=!1,this.visible=!1,this.fadeTimer=null,this.timer=null,this.yearInc=0,this.monthInc=0,this.dayInc=0,this.mx=0,this.my=0,this.x=0,this.y=0,this.date=new Date,this.defaults={},this.created=!1,this.disabled=!1,this.id=e.id,this.opacity=0,this.firstDayOfWeek=localeImport.firstDayOfWeek,this.buttonWrapper="buttonWrapper"in e?e.buttonWrapper:!1,this.staticPos="staticPos"in e?!!e.staticPos:!1,this.disabledDays="disabledDays"in e&&e.disabledDays.length?e.disabledDays:[0,0,0,0,0,0,0],this.disabledDates="disabledDates"in e?e.disabledDates:{},this.enabledDates="enabledDates"in e?e.enabledDates:{},this.showWeeks="showWeeks"in e?!!e.showWeeks:!1,this.low=e.low||"",this.high=e.high||"",this.dragDisabled=nodrag?!0:"dragDisabled"in e?!!e.dragDisabled:!1,this.positioned="positioned"in e?e.positioned:!1,this.hideInput=this.staticPos?!1:"hideInput"in e?!!e.hideInput:!1,this.splitDate="splitDate"in e?!!e.splitDate:!1,this.format=e.format||"d-sl-m-sl-Y",this.statusFormat=e.statusFormat||"",this.highlightDays=e.highlightDays&&e.highlightDays.length?e.highlightDays:[0,0,0,0,0,1,1],this.noFadeEffect="noFadeEffect"in e?!!e.noFadeEffect:!1,this.opacityTo=this.noFadeEffect||this.staticPos?99:90,this.callbacks={},this.fillGrid=!!e.fillGrid,this.noToday=!!e.noToday,this.labelledBy="labelledBy"in e?e.labelledBy:"",this.constrainSelection=this.fillGrid&&!!e.constrainSelection,this.finalOpacity=!this.staticPos&&"finalOpacity"in e?+e.finalOpacity:90,this.dynDisabledDates={},this.inUpdate=!1,this.noFocus=!0,this.kbEventsAdded=!1,this.fullCreate=!1,this.selectedTD=null,this.cursorTD=null,this.addSpans=this.staticPos,this.spansAdded=!1;for(var t in e.callbacks)this.callbacks[t]=e.callbacks[t];this.date.setHours(12),this.changeHandler=function(){a.setDateFromInput(),a.created&&a.updateTable()},this.getScrollOffsets=function(){return"number"==typeof window.pageYOffset?[window.pageXOffset,window.pageYOffset]:document.body&&(document.body.scrollLeft||document.body.scrollTop)?[document.body.scrollLeft,document.body.scrollTop]:document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)?[document.documentElement.scrollLeft,document.documentElement.scrollTop]:[0,0]},this.reposition=function(){if(a.created&&a.getElem()&&!a.staticPos){a.div.style.visibility="hidden",a.div.style.left=a.div.style.top="0px",a.div.style.display="block";var e=a.div.offsetHeight,t=a.div.offsetWidth,s=document.getElementById("fd-but-"+a.id),i=a.truePosition(s),n=document.compatMode&&"BackCompat"!=document.compatMode?document.documentElement:document.body,r=a.getScrollOffsets(),d=r[1],o=r[0];a.div.style.visibility="visible",a.div.style.left=Number(parseInt(n.clientWidth+o)<parseInt(t+i[0])?Math.abs(parseInt(n.clientWidth+o-t)):i[0])+"px",a.div.style.top=Number(parseInt(n.clientHeight+d)<parseInt(e+i[1]+s.offsetHeight+2)?Math.abs(parseInt(i[1]-(e+2))):Math.abs(parseInt(i[1]+s.offsetHeight+2)))+"px"}},this.removeOldFocus=function(){var e=document.getElementById(a.id+"-date-picker-hover");if(e)try{e.setAttribute("tabIndex","-1"),e.tabIndex=-1,e.className=e.className.replace(/date-picker-hover/,""),e.id=""}catch(t){}},this.setNewFocus=function(){var e=document.getElementById(a.id+"-date-picker-hover");if(e)try{e.setAttribute("tabIndex","0"),e.tabIndex=0,e.className=e.className.replace(/date-picker-hover/,"")+" date-picker-hover",this.noFocus||setTimeout(function(){try{e.focus()}catch(t){}},0)}catch(t){}},this.updateTable=function(e){if(!a.inUpdate){a.inUpdate=!0,a.removeOldFocus(),a.timerSet&&(a.date.setDate(Math.min(a.date.getDate()+a.dayInc,daysInMonth(a.date.getMonth()+a.monthInc,a.date.getFullYear()+a.yearInc))),a.date.setMonth(a.date.getMonth()+a.monthInc),a.date.setFullYear(a.date.getFullYear()+a.yearInc)),a.outOfRange(),a.noToday||a.disableTodayButton(),a.showHideButtons(a.date);var t=a.date.getDate(),s=a.date.getMonth(),i=a.date.getFullYear(),n=String(i)+pad(s+1)+pad(t),r=new Date(i,s,1);r.setHours(5);var d,o,l,c,h,u,p,m,f=(r.getDay()+6)%7,g=(f-a.firstDayOfWeek+7)%7-1,b=daysInMonth(s,i),y=new Date,v=null!=a.dateSet?a.dateSet.getFullYear()+pad(a.dateSet.getMonth()+1)+pad(a.dateSet.getDate()):!1,k=String(r.getFullYear())+pad(r.getMonth()+1),h=[4,4,4,4,4,4],D=new Date(i,s-1,1),w=new Date(i,s+1,1),N=daysInMonth(D.getMonth(),D.getFullYear()),T=String(w.getFullYear())+pad(w.getMonth()+1),E=String(D.getFullYear())+pad(D.getMonth()+1),I=(w.getDay()+6)%7,P=(D.getDay()+6)%7,y=y.getFullYear()+pad(y.getMonth()+1)+pad(y.getDate()),S=document.createElement("span");a.firstDateShown=!a.constrainSelection&&a.fillGrid&&1>0-g?String(E)+(N+(0-g)):k+"01",a.lastDateShown=!a.constrainSelection&&a.fillGrid?T+pad(41-g-b):k+String(b),a.currentYYYYMM=k,p=a.callback("redraw",{id:a.id,dd:pad(t),mm:pad(s+1),yyyy:i,firstDateDisplayed:a.firstDateShown,lastDateDisplayed:a.lastDateShown})||{},a.dynDisabledDates=a.getDisabledDates(i,s+1),S.className="fd-screen-reader",null!=this.selectedTD&&(setARIAProperty(this.selectedTD,"selected",!1),this.selectedTD=null);for(var F=0;42>F;F++){for(row=Math.floor(F/7),l=a.tds[F],m=S.cloneNode(!1);l.firstChild;)l.removeChild(l.firstChild);if(F>g&&g+b>=F||a.fillGrid)if(u=k,weekDay=f,d=F-g,o=[],selectable=!0,1>d?(d=N+d,u=E,weekDay=P,selectable=!a.constrainSelection,o.push("month-out")):d>b&&(d-=b,u=T,weekDay=I,selectable=!a.constrainSelection,o.push("month-out")),weekDay=(weekDay+d+6)%7,o.push("day-"+localeDefaults.dayAbbrs[weekDay].toLowerCase()),c=u+String(10>d?"0":"")+d,a.low&&+c<+a.low||a.high&&+c>+a.high)l.className="out-of-range",l.title="",l.appendChild(document.createTextNode(d)),a.showWeeks&&(h[row]=Math.min(h[row],2));else{if(selectable?(l.title=titleFormat?printFormattedDate(new Date(+String(u).substr(0,4),+String(u).substr(4,2)-1,+d),titleFormat,!0):"",o.push("cd-"+c+" yyyymm-"+u+" mmdd-"+u.substr(4,2)+pad(d))):(l.title=titleFormat?getTitleTranslation(13)+" "+printFormattedDate(new Date(+String(u).substr(0,4),+String(u).substr(4,2)-1,+d),titleFormat,!0):"",o.push("yyyymm-"+u+" mmdd-"+u.substr(4,2)+pad(d)+" not-selectable")),c==y&&o.push("date-picker-today"),v==c&&(o.push("date-picker-selected-date"),setARIAProperty(l,"selected","true"),this.selectedTD=l),(a.disabledDays[weekDay]||c in a.dynDisabledDates)&&(o.push("day-disabled"),titleFormat&&selectable&&(l.title=getTitleTranslation(13)+" "+l.title)),c in p&&o.push(p[c]),a.highlightDays[weekDay]&&o.push("date-picker-highlight"),n==c&&(l.id=a.id+"-date-picker-hover"),l.className=o.join(" "),a.kbEventsAdded||a.addSpans)for(var x,C=0;x=formatParts[C];C++)"placeholder"==x?l.appendChild(document.createTextNode(d)):(m=S.cloneNode(S),m.appendChild(document.createTextNode(printFormattedDate(new Date(+String(u).substr(0,4),+String(u).substr(4,2)-1,+d),x,!0))),l.appendChild(m));else l.appendChild(document.createTextNode(d));a.showWeeks&&(h[row]=Math.min("month-out"==o[0]?3:1,h[row]))}else l.className="date-picker-unused",l.appendChild(document.createTextNode(nbsp)),l.title="";if(a.showWeeks&&F-7*row==6){for(;a.wkThs[row].firstChild;)a.wkThs[row].removeChild(a.wkThs[row].firstChild);a.wkThs[row].appendChild(document.createTextNode(4!=h[row]||a.fillGrid?getWeekNumber(i,s,F-g-6):nbsp)),a.wkThs[row].className="date-picker-week-header"+["",""," out-of-range"," month-out",""][h[row]]}}a.spansAdded=a.kbEventsAdded||a.addSpans;for(var M=a.titleBar.getElementsByTagName("span");M[0].firstChild;)M[0].removeChild(M[0].firstChild);for(;M[1].firstChild;)M[1].removeChild(M[1].firstChild);M[0].appendChild(document.createTextNode(getMonthTranslation(s,!1)+nbsp)),M[1].appendChild(document.createTextNode(i)),a.timerSet&&(a.timerInc=50+Math.round((a.timerInc-50)/1.8),a.timer=window.setTimeout(a.updateTable,a.timerInc)),a.inUpdate=!1,a.setNewFocus()}},this.show=function(e){if(!this.staticPos){var t=this.getElem();if(!(!t||t&&t.disabled)){this.noFocus=!0,document.getElementById("fd-"+this.id)?(this.setDateFromInput(),this.reposition()):(this.created=!1,this.fullCreate=!1,this.create(),this.fullCreate=!0),this.noFocus=!e,this.noFocus&&addEvent(document,"mousedown",this.onmousedown),this.updateTable(),this.opacityTo=this.finalOpacity,this.div.style.display="block",this.setNewFocus(),this.fade();var a=document.getElementById("fd-but-"+this.id);a&&(a.className=a.className.replace("dp-button-active","")+" dp-button-active")}}},this.hide=function(){if(this.visible&&this.created&&document.getElementById("fd-"+this.id)&&(this.stopTimer(),this.removeFocusEvents(),!this.staticPos)){var e=document.getElementById("fd-but-"+this.id);e&&(e.className=e.className.replace("dp-button-active","")),removeEvent(document,"mousedown",this.onmousedown),this.opacityTo=0,this.fade(),this.div.className=this.div.className.replace("datepicker-focus",""),this.statusBar&&this.updateStatus(getTitleTranslation(9))}},this.destroy=function(){document.getElementById("fd-but-"+this.id)&&document.getElementById("fd-but-"+this.id).parentNode.removeChild(document.getElementById("fd-but-"+this.id)),this.created&&(removeEvent(this.table,"mousedown",a.onmousedown),removeEvent(this.table,"mouseover",a.onmouseover),removeEvent(this.table,"mouseout",a.onmouseout),removeEvent(document,"mousedown",a.onmousedown),removeEvent(document,"mouseup",a.clearTimer),a.removeFocusEvents(),clearTimeout(a.fadeTimer),clearTimeout(a.timer),this.div&&this.div.parentNode&&this.div.parentNode.removeChild(this.div),a=null)},this.resizeInlineDiv=function(){a.div.style.width=a.table.offsetWidth+"px",a.div.style.height=a.table.offsetHeight+"px"},this.create=function(){function e(e){var t=document.createElement("th");return e.thClassName&&(t.className=e.thClassName),e.colspan&&t.setAttribute("colspan",e.colspan),t}function t(t,s){for(var i,n=0;i=s[n];n++){var r=e(i);t.appendChild(r);var d=document.createElement("span");d.className=i.className,d.id=a.id+i.id,d.appendChild(document.createTextNode(i.text||a.nbsp)),d.title=i.title||"",r.appendChild(d)}}if(!this.created){this.noFocus=!0,this.div=document.createElement("div"),this.div.id="fd-"+this.id,this.div.className="datePicker",this.div.style.visibility="hidden",this.div.style.display="none",document.getElementById("fd-datepicker-aria-describedby")&&setARIAProperty(this.div,"describedby","fd-datepicker-aria-describedby"),this.labelledBy&&setARIAProperty(this.div,"labelledby",this.labelledBy.id);var s,i,n,r,d,o;this.table=document.createElement("table"),this.table.className="datePickerTable",this.table.onmouseover=this.onmouseover,this.table.onmouseout=this.onmouseout,this.table.onclick=this.onclick,this.staticPos&&(this.table.onmousedown=this.onmousedown),this.div.appendChild(this.table);var l=this.dragDisabled?"":" drag-enabled";if(this.staticPos){if(elem=this.positioned?document.getElementById(this.positioned):this.getElem(),!elem)throw this.div=null,this.positioned?"Could not locate a datePickers associated parent element with an id:"+this.positioned:"Could not locate a datePickers associated input with an id:"+this.id;if(this.div.className+=" static-datepicker",this.positioned?elem.appendChild(this.div):elem.parentNode.insertBefore(this.div,elem.nextSibling),this.hideInput){var c=[elem];this.splitDate&&(c[c.length]=document.getElementById(this.id+splitAppend[1]),c[c.length]=document.getElementById(this.id+splitAppend[0]));for(var h=0;h<c.length;h++)c[h].tagName&&(c[h].className+=" fd-hidden-input")}setTimeout(this.resizeInlineDiv,300)}else this.div.style.visibility="hidden",this.div.className+=l,document.getElementsByTagName("body")[0].appendChild(this.div),setARIAProperty(this.div,"hidden","true");setARIARole(this.div,"grid"),this.statusFormat&&(o=document.createElement("tfoot"),this.table.appendChild(o),s=document.createElement("tr"),s.className="date-picker-tfoot",o.appendChild(s),this.statusBar=e({thClassName:"date-picker-statusbar"+l,colspan:this.showWeeks?8:7}),s.appendChild(this.statusBar),this.updateStatus()),r=document.createElement("thead"),this.table.appendChild(r),s=document.createElement("tr"),setARIARole(s,"presentation"),r.appendChild(s),this.titleBar=e({thClassName:"date-picker-title"+l,colspan:this.showWeeks?8:7}),s.appendChild(this.titleBar),s=null;var u=document.createElement("span");u.appendChild(document.createTextNode(nbsp)),u.className="month-display"+l,this.titleBar.appendChild(u),u=document.createElement("span"),u.appendChild(document.createTextNode(nbsp)),u.className="year-display"+l,this.titleBar.appendChild(u),u=null,s=document.createElement("tr"),setARIARole(s,"presentation"),r.appendChild(s),t(s,[{className:"prev-but prev-year",id:"-prev-year-but",text:"«",title:getTitleTranslation(2)},{className:"prev-but prev-month",id:"-prev-month-but",text:"‹",title:getTitleTranslation(0)},{colspan:this.showWeeks?4:3,className:"today-but",id:"-today-but",text:getTitleTranslation(4)},{className:"next-but next-month",id:"-next-month-but",text:"›",title:getTitleTranslation(1)},{className:"next-but next-year",id:"-next-year-but",text:"»",title:getTitleTranslation(3)}]),d=document.createElement("tbody"),this.table.appendChild(d);for(var p,m=this.showWeeks?8:7,f=this.showWeeks?0:-1,g=0;7>g;g++){i=document.createElement("tr"),0!=g?(setARIARole(i,"row"),d.appendChild(i)):r.appendChild(i);for(var b=0;m>b;b++)0===g||this.showWeeks&&0===b?n=document.createElement("th"):(n=document.createElement("td"),n.onblur=this.onblur,n.onfocus=this.onfocus,setARIAProperty(n,"describedby",this.id+"-col-"+b+(this.showWeeks?" "+this.id+"-row-"+g:"")),setARIAProperty(n,"selected","false")),i.appendChild(n),this.showWeeks&&b>0&&g>0||!this.showWeeks&&g>0?setARIARole(n,"gridcell"):0===g&&b>f?(n.className="date-picker-day-header",n.scope="col",setARIARole(n,"columnheader"),n.id=this.id+"-col-"+b):(n.className="date-picker-week-header",n.scope="row",setARIARole(n,"rowheader"),n.id=this.id+"-row-"+g)}n=i=null,this.ths=this.table.getElementsByTagName("thead")[0].getElementsByTagName("tr")[2].getElementsByTagName("th");for(var y=0;m>y;y++)0==y&&this.showWeeks?(this.ths[y].appendChild(document.createTextNode(getTitleTranslation(6))),this.ths[y].title=getTitleTranslation(8)):y>(this.showWeeks?0:-1)&&(p=document.createElement("span"),p.className="fd-day-header",this.ths[y].appendChild(p));p=null,this.trs=this.table.getElementsByTagName("tbody")[0].getElementsByTagName("tr"),this.tds=this.table.getElementsByTagName("tbody")[0].getElementsByTagName("td"),this.butPrevYear=document.getElementById(this.id+"-prev-year-but"),this.butPrevMonth=document.getElementById(this.id+"-prev-month-but"),this.butToday=document.getElementById(this.id+"-today-but"),this.butNextYear=document.getElementById(this.id+"-next-year-but"),this.butNextMonth=document.getElementById(this.id+"-next-month-but"),this.noToday&&(this.butToday.style.display="none"),this.showWeeks&&(this.wkThs=this.table.getElementsByTagName("tbody")[0].getElementsByTagName("th"),this.div.className+=" weeks-displayed"),d=r=s=t=e=null,this.low&&this.high&&this.high-this.low<7&&this.equaliseDates(),this.setDateFromInput(),this.updateTableHeaders(),this.created=!0,this.callback("create",{id:this.id}),this.updateTable(),this.staticPos?(this.visible=!0,this.opacity=this.opacityTo,this.div.style.visibility="visible",this.div.style.display="block",this.noFocus=!0,this.fade()):(this.reposition(),this.div.style.visibility="visible",this.fade(),this.noFocus=!0),this.addSpans=!1}},this.fade=function(){window.clearTimeout(a.fadeTimer),a.fadeTimer=null;var e=Math.round(a.opacity+(a.opacityTo-a.opacity)/4);a.setOpacity(e),Math.abs(a.opacityTo-e)>3&&!a.noFadeEffect?a.fadeTimer=window.setTimeout(a.fade,50):(a.setOpacity(a.opacityTo),0==a.opacityTo?(a.div.style.display="none",a.div.style.visibility="hidden",setARIAProperty(a.div,"hidden","true"),a.visible=!1):(setARIAProperty(a.div,"hidden","false"),a.visible=!0))},this.trackDrag=function(e){e=e||window.event;var t=(e.pageX?e.pageX:e.clientX?e.clientX:e.x)-a.mx,s=(e.pageY?e.pageY:e.clientY?e.clientY:e.Y)-a.my;a.div.style.left=Math.round(a.x+t)>0?Math.round(a.x+t)+"px":"0px",a.div.style.top=Math.round(a.y+s)>0?Math.round(a.y+s)+"px":"0px"},this.stopDrag=function(e){removeEvent(document,"mousemove",a.trackDrag,!1),removeEvent(document,"mouseup",a.stopDrag,!1),a.div.style.zIndex=9999},this.onmousedown=function(e){e=e||document.parentWindow.event;var t=null!=e.target?e.target:e.srcElement,s=t,i=!0,n=new RegExp("^fd-(but-)?"+a.id+"$");for(a.mouseDownElem=null;t;){if(t.id&&t.id.length&&-1!=t.id.search(n)){i=!1;break}try{t=t.parentNode}catch(r){break}}if(i)return hideAll(),!0;if(-1!=(a.div.className+s.className).search("fd-disabled"))return!0;if(-1!=s.id.search(new RegExp("^"+a.id+"(-prev-year-but|-prev-month-but|-next-month-but|-next-year-but)$"))){a.mouseDownElem=s,addEvent(document,"mouseup",a.clearTimer),addEvent(s,"mouseout",a.clearTimer);var d={"-prev-year-but":[0,-1,0],"-prev-month-but":[0,0,-1],"-next-year-but":[0,1,0],"-next-month-but":[0,0,1]},o=s.id.replace(a.id,""),l=Number(a.date.getFullYear()+pad(a.date.getMonth()+1));a.timerInc=a.currentYYYYMM>l||a.currentYYYYMM<l?1600:800,a.timerSet=!0,a.dayInc=d[o][0],a.yearInc=d[o][1],a.monthInc=d[o][2],a.addSpans=!1,a.updateTable()}else-1!=t.className.search("drag-enabled")&&(a.mx=e.pageX?e.pageX:e.clientX?e.clientX:e.x,a.my=e.pageY?e.pageY:e.clientY?e.clientY:e.Y,a.x=parseInt(a.div.style.left),a.y=parseInt(a.div.style.top),addEvent(document,"mousemove",a.trackDrag,!1),addEvent(document,"mouseup",a.stopDrag,!1),a.div.style.zIndex=1e4);return!0},this.onclick=function(e){if(a.opacity!=a.opacityTo||a.disabled)return stopEvent(e);e=e||document.parentWindow.event;for(var t=null!=e.target?e.target:e.srcElement;t.parentNode;){if(t.tagName&&"td"==t.tagName.toLowerCase()){if(-1==t.className.search(/cd-([0-9]{8})/)||-1!=t.className.search(/date-picker-unused|out-of-range|day-disabled|no-selection|not-selectable/))return stopEvent(e);var s=t.className.match(/cd-([0-9]{8})/)[1];a.date=new Date(s.substr(0,4),s.substr(4,2)-1,s.substr(6,2)),a.dateSet=new Date(a.date),a.noFocus=!0,a.returnFormattedDate(),a.hide(),a.stopTimer();break}if(t.id&&t.id==a.id+"-today-but"){a.date=new Date,a.updateTable(),a.stopTimer();break}if(-1!=t.className.search(/date-picker-day-header/)){for(var i=a.showWeeks?-1:0,n=t;n.previousSibling;)n=n.previousSibling,"th"==n.tagName.toLowerCase()&&i++;a.firstDayOfWeek=(a.firstDayOfWeek+i)%7,a.updateTableHeaders();break}try{t=t.parentNode}catch(r){break}}return stopEvent(e)},this.onblur=function(e){e=e||document.parentWindow.event;for(var t=null!=e.target?e.target:e.srcElement;t.parentNode;){if(t.id&&t.id=="fd-"+a.id)return!0;try{t=t.parentNode}catch(s){break}}a.kbEventsAdded&&a.removeFocusEvents(),a.div.className=a.div.className.replace("datepicker-focus",""),a.noFocus=!0,a.addSpans=!1,a.hide(),a.statusBar&&a.updateStatus(getTitleTranslation(9))},this.onfocus=function(e){a.staticPos&&(a.noFocus=!1,a.spansAdded||(a.addSpans=!0,a.updateTable())),a.addFocusEvents(),a.noFocus=!1},this.onkeydown=function(e){if(a.stopTimer(),!a.visible)return!1;null==e&&(e=document.parentWindow.event);var t=e.keyCode?e.keyCode:e.charCode;if(13==t){var s=document.getElementById(a.id+"-date-picker-hover");return s&&-1!=s.className.search(/cd-([0-9]{8})/)&&-1==s.className.search(/no-selection|out-of-range|day-disabled/)?(a.dateSet=new Date(a.date),a.returnFormattedDate(),a.hide(),stopEvent(e)):stopEvent(e)}if(27==t)return a.hide(),stopEvent(e);if(32==t||0==t)return a.date=new Date,a.updateTable(),stopEvent(e);if(t>49&&56>t||t>97&&104>t)return t>96&&(t-=48),t-=49,a.firstDayOfWeek=(a.firstDayOfWeek+t)%7,a.updateTableHeaders(),stopEvent(e);if(33>t||t>40)return!0;var i,n=new Date(a.date),r=a.date.getFullYear()+pad(a.date.getMonth()+1);if(36==t)n.setDate(1);else if(35==t)n.setDate(daysInMonth(n.getMonth(),n.getFullYear()));else if(33==t||34==t){var d=34==t?1:-1;e.ctrlKey?n.setFullYear(n.getFullYear()+d):33==t&&a.currentYYYYMM>r||34==t&&a.currentYYYYMM<r||(i=new Date(n),i.setDate(2),i.setMonth(n.getMonth()+d),n.setDate(Math.min(n.getDate(),daysInMonth(i.getMonth(),i.getFullYear()))),n.setMonth(n.getMonth()+d))}else 37==t?n=new Date(a.date.getFullYear(),a.date.getMonth(),a.date.getDate()-1):39==t||34==t?n=new Date(a.date.getFullYear(),a.date.getMonth(),a.date.getDate()+1):38==t?n=new Date(a.date.getFullYear(),a.date.getMonth(),a.date.getDate()-7):40==t&&(n=new Date(a.date.getFullYear(),a.date.getMonth(),a.date.getDate()+7));if(a.outOfRange(n))return stopEvent(e);a.date=n,a.statusBar&&a.updateStatus(printFormattedDate(a.date,a.statusFormat,!0));var o=String(a.date.getFullYear())+pad(a.date.getMonth()+1)+pad(a.date.getDate());if(e.ctrlKey||33==t||34==t||o<a.firstDateShown||o>a.lastDateShown)a.updateTable();else{a.noToday||a.disableTodayButton(),a.removeOldFocus();for(var s,l="cd-"+a.date.getFullYear()+pad(a.date.getMonth()+1)+pad(a.date.getDate()),c=0;s=a.tds[c];c++)if(-1!=s.className.search(l)){a.showHideButtons(a.date),s.id=a.id+"-date-picker-hover",a.setNewFocus();break}}return stopEvent(e)},this.onmouseout=function(e){e=e||document.parentWindow.event;for(var t=e.toElement||e.relatedTarget;t&&t!=this;)try{t=t.parentNode}catch(e){t=this}return t==this?!1:(a.currentTR&&(a.currentTR.className="",a.currentTR=null),void(a.statusBar&&a.updateStatus(printFormattedDate(a.date,a.statusFormat,!0))))},this.onmouseover=function(e){e=e||document.parentWindow.event;for(var t=null!=e.target?e.target:e.srcElement;1!=t.nodeType;)t=t.parentNode;if(t&&t.tagName){var s=getTitleTranslation(9);switch(t.tagName.toLowerCase()){case"td":if(-1!=t.className.search(/date-picker-unused|out-of-range/)&&(s=getTitleTranslation(9)),-1!=t.className.search(/cd-([0-9]{8})/)){a.stopTimer();var i=t.className.match(/cd-([0-9]{8})/)[1];a.removeOldFocus(),t.id=a.id+"-date-picker-hover",a.setNewFocus(),a.date=new Date(+i.substr(0,4),+i.substr(4,2)-1,+i.substr(6,2)),a.noToday||a.disableTodayButton(),s=printFormattedDate(a.date,a.statusFormat,!0)}break;case"th":if(!a.statusBar)break;if(-1!=t.className.search(/drag-enabled/))s=getTitleTranslation(10);else if(-1!=t.className.search(/date-picker-week-header/)){var n=t.firstChild?t.firstChild.nodeValue:"";s=-1!=n.search(/^(\d+)$/)?getTitleTranslation(7,[n,3>n&&11==a.date.getMonth()?getWeeksInYear(a.date.getFullYear())+1:getWeeksInYear(a.date.getFullYear())]):getTitleTranslation(9)}break;case"span":if(!a.statusBar)break;if(-1!=t.className.search(/drag-enabled/))s=getTitleTranslation(10);else if(-1!=t.className.search(/day-([0-6])/)){var r=t.className.match(/day-([0-6])/)[1];s=getTitleTranslation(11,[getDayTranslation(r,!1)])}else-1!=t.className.search(/prev-year/)?s=getTitleTranslation(2):-1!=t.className.search(/prev-month/)?s=getTitleTranslation(0):-1!=t.className.search(/next-year/)?s=getTitleTranslation(3):-1!=t.className.search(/next-month/)?s=getTitleTranslation(1):-1!=t.className.search(/today-but/)&&-1==t.className.search(/disabled/)&&(s=getTitleTranslation(12));break;default:s=""}for(;t.parentNode;)if(t=t.parentNode,1==t.nodeType&&"tr"==t.tagName.toLowerCase()){if(a.currentTR){if(t==a.currentTR)break;a.currentTR.className=""}t.className="dp-row-highlight",a.currentTR=t;break}a.statusBar&&s&&a.updateStatus(s)}},this.clearTimer=function(){a.stopTimer(),a.timerInc=800,a.yearInc=0,a.monthInc=0,a.dayInc=0,removeEvent(document,"mouseup",a.clearTimer),null!=a.mouseDownElem&&removeEvent(a.mouseDownElem,"mouseout",a.clearTimer),a.mouseDownElem=null};var a=this;this.staticPos?this.create():this.createButton(),this.setDateFromInput(),function(){var e=a.getElem();e&&e.tagName&&-1!=e.tagName.search(/select|input/i)&&(addEvent(e,"change",a.changeHandler),this.splitDate&&(addEvent(document.getElementById(a.id+splitAppend[1]),"change",a.changeHandler),addEvent(document.getElementById(a.id+splitAppend[0]),"change",a.changeHandler))),e&&1!=e.disabled||a.disableDatePicker()}(),this.fullCreate=!0}var languageInfo=navigator.language?navigator.language.toLowerCase().replace(/-[a-z]+$/,""):navigator.userLanguage?navigator.userLanguage.toLowerCase().replace(/-[a-z]+$/,""):"en",datePickers={},uniqueId=0,weeksInYearCache={},localeImport=!1,nbsp=String.fromCharCode(160),nodrag=!1,buttonTabIndex=!0,returnLocaleDate=!1,splitAppend=["-dd","-mm"],cellFormat="d-sp-F-sp-Y",titleFormat="F-sp-d-cc-sp-Y",formatParts=["placeholder","sp-F-sp-Y"],formatMasks=["Y-sl-m-sl-d","m-sl-d-sl-Y","d-sl-m-sl-Y","Y-ds-m-ds-d","m-ds-d-ds-Y","d-ds-m-ds-Y","d-ds-m-ds-y","d-sl-m-sl-y"];switch(languageInfo.length>2&&(languageInfo=languageInfo.substring(0,2)),languageInfo){case"es":case"en":case"fr":case"ca":case"eu":case"ga":break;default:languageInfo="en"}void function(){var e=document.getElementsByTagName("head")[0].getElementsByTagName("script"),t=e[e.length-1].innerHTML.replace(/[\n\r\s\t]+/g," ").replace(/^\s+/,"").replace(/\s+$/,""),a=parseJSON(t);if("object"!=typeof a||"err"in a||affectJSON(a),"object"!=typeof fdLocale){var s=e[e.length-1].src.substr(0,e[e.length-1].src.lastIndexOf("/"))+"/lang/"+languageInfo+".js",i=document.createElement("script");i.type="text/javascript",i.src=s,i.setAttribute("charset","utf-8"),document.getElementsByTagName("head")[0].appendChild(i),i=null}else returnLocaleDate=!0}(),datePicker.prototype.addButtonEvents=function(e){e.onkeydown=e.onclick=function(e){e=e||window.event;var t=this.id.replace("fd-but-",""),a=isVisible(t),s=!1;if("keydown"==e.type){var i=null!=e.keyCode?e.keyCode:e.charCode;if(13!=i)return!0;if(a)return this.className=this.className.replace("dp-button-active",""),hideAll(),!1;s=!0}return this.className=this.className.replace("dp-button-active",""),a?hideAll():(this.className+=" dp-button-active",hideAll(t),showDatePicker(t,s)),!1},buttonTabIndex?(e.setAttribute("tabIndex","0"),e.tabIndex=0):(e.setAttribute("tabIndex","-1"),e.tabIndex=-1,e.onkeydown=null)},datePicker.prototype.createButton=function(){if(!this.staticPos&&!document.getElementById("fd-but-"+this.id)){var e=this.getElem(),t=document.createElement("span"),a=document.createElement("a");a.href="#"+this.id,a.className="date-picker-control",a.title=getTitleTranslation(5),a.id="fd-but-"+this.id,t.appendChild(document.createTextNode(nbsp)),a.appendChild(t),t=document.createElement("span"),t.className="fd-screen-reader",t.appendChild(document.createTextNode(a.title)),a.appendChild(t),setARIARole(a,"button"),setARIAProperty(a,"haspopup",!0),this.buttonWrapper&&document.getElementById(this.buttonWrapper)?document.getElementById(this.buttonWrapper).appendChild(a):e.nextSibling?e.parentNode.insertBefore(a,e.nextSibling):e.parentNode.appendChild(a),this.addButtonEvents(a),a=null}},datePicker.prototype.setRangeLow=function(e){this.low=-1==String(e).search(/^(\d\d\d\d)(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01])$/)?!1:e,this.checkSelectedDate(),this.created&&this.updateTable()},datePicker.prototype.setRangeHigh=function(e){this.high=-1==String(e).search(/^(\d\d\d\d)(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01])$/)?!1:e,this.checkSelectedDate(),this.created&&this.updateTable()},datePicker.prototype.setDisabledDays=function(e){this.disabledDays=e,this.checkSelectedDate(),this.created&&this.updateTable()},datePicker.prototype.setDisabledDates=function(e){this.disabledDates={},this.addDisabledDates(e)},datePicker.prototype.addDisabledDates=function(e){"object"!=typeof e&&(e=[e]);for(var t=e.length;t--;)-1!=e[t].match(/^(\d\d\d\d|\*\*\*\*)(0[1-9]|1[012]|\*\*)(0[1-9]|[12][0-9]|3[01])$/)&&(this.disabledDates[e[t]]=1);this.checkSelectedDate(),this.created&&this.updateTable()},datePicker.prototype.checkSelectedDate=function(){this.dateSet&&(this.canDateBeSelected(this.dateSet)||(this.dateSet=null))},datePicker.prototype.addFocusEvents=function(){this.kbEventsAdded||this.noFocus||(this.div.className=this.div.className.replace(/datepicker-focus/,"")+" datepicker-focus",addEvent(document,"keypress",this.onkeydown),addEvent(document,"mousedown",this.onmousedown),window.devicePixelRatio&&(removeEvent(document,"keypress",this.onkeydown),addEvent(document,"keydown",this.onkeydown)),this.noFocus=!1,this.kbEventsAdded=!0)},datePicker.prototype.removeFocusEvents=function(){this.kbEventsAdded&&(this.div.className=this.div.className.replace(/datepicker-focus/,""),removeEvent(document,"keypress",this.onkeydown),removeEvent(document,"keydown",this.onkeydown),removeEvent(document,"mousedown",this.onmousedown),this.noFocus=!0,this.kbEventsAdded=!1)},datePicker.prototype.stopTimer=function(){this.timerSet=!1,window.clearTimeout(this.timer)},datePicker.prototype.setOpacity=function(e){this.div.style.opacity=e/100,this.div.style.filter="alpha(opacity="+e+")",this.opacity=e},datePicker.prototype.getElem=function(){return document.getElementById(this.id.replace(/^fd-/,""))||!1},datePicker.prototype.getDisabledDates=function(e,t){t=pad(t);var a,s,i,n,r={},d=this.firstDateShown,o=this.lastDateShown;o&&d||(d=this.firstDateShown=e+pad(t)+"01",o=this.lastDateShown=e+pad(t)+pad(daysInMonth(t,e)));for(var l in this.disabledDates)if(a=l.replace(/^(\*\*\*\*)/,e).replace(/^(\d\d\d\d)(\*\*)/,"$1"+t),s=this.disabledDates[l],1!=s){if(Number(a.substr(0,6))<=+String(this.firstDateShown).substr(0,6)&&Number(s.substr(0,6))>=+String(this.lastDateShown).substr(0,6)){if(Number(a.substr(0,6))==Number(s.substr(0,6))){for(var c=a;s>=c;c++)r[c]=1;continue}i=Number(a.substr(0,6))==+String(this.firstDateShown).substr(0,6)?a:d,n=Number(s.substr(0,6))==+String(this.lastDateShown).substr(0,6)?s:o;for(var c=+i;+n>=c;c++)r[c]=1}}else+a>=+d&&+o>=+a&&(r[a]=1);
for(l in this.enabledDates)if(a=l.replace(/^(\*\*\*\*)/,e).replace(/^(\d\d\d\d)(\*\*)/,"$1"+t),s=this.enabledDates[l],1!=s){if(Number(a.substr(0,6))<=+String(this.firstDateShown).substr(0,6)&&Number(s.substr(0,6))>=+String(this.lastDateShown).substr(0,6)){if(Number(a.substr(0,6))==Number(s.substr(0,6))){for(var c=a;s>=c;c++)c in r&&(r[c]=null,delete r[c]);continue}i=Number(a.substr(0,6))==+String(this.firstDateShown).substr(0,6)?a:d,n=Number(s.substr(0,6))==+String(this.lastDateShown).substr(0,6)?s:o;for(var c=+i;+n>=c;c++)c in r&&(r[c]=null,delete r[c])}}else a in r&&(r[a]=null,delete r[a]);return r},datePicker.prototype.truePosition=function(e){var t=this.cumulativeOffset(e);if(window.opera)return t;var a=document.compatMode&&"BackCompat"!=document.compatMode?document.documentElement:document.body,s=document.all?a.scrollLeft:window.pageXOffset,i=document.all?a.scrollTop:window.pageYOffset,n=this.realOffset(e);return[t[0]-n[0]+s,t[1]-n[1]+i]},datePicker.prototype.realOffset=function(e){var t=0,a=0;do t+=e.scrollTop||0,a+=e.scrollLeft||0,e=e.parentNode;while(e);return[a,t]},datePicker.prototype.cumulativeOffset=function(e){var t=0,a=0;do t+=e.offsetTop||0,a+=e.offsetLeft||0,e=e.offsetParent;while(e);return[a,t]},datePicker.prototype.equaliseDates=function(){for(var e,t=!1,a=this.low;a<=this.high;a++)if(e=String(a),!this.disabledDays[new Date(e.substr(0,4),e.substr(6,2),e.substr(4,2)).getDay()-1]){t=!0;break}t||(this.disabledDays=[0,0,0,0,0,0,0])},datePicker.prototype.outOfRange=function(e){if(!this.low&&!this.high)return!1;var t=!1;e||(t=!0,e=this.date);var a=pad(e.getDate()),s=pad(e.getMonth()+1),i=e.getFullYear(),n=String(i)+String(s)+String(a);if(this.low&&+n<+this.low)return t?(this.date=new Date(this.low.substr(0,4),this.low.substr(4,2)-1,this.low.substr(6,2),5,0,0),!1):!0;if(this.high&&+n>+this.high){if(!t)return!0;this.date=new Date(this.high.substr(0,4),this.high.substr(4,2)-1,this.high.substr(6,2),5,0,0)}return!1},datePicker.prototype.canDateBeSelected=function(e){if(!e)return!1;var t=pad(e.getDate()),a=pad(e.getMonth()+1),s=e.getFullYear(),i=String(s)+String(a)+String(t),n=this.getDisabledDates(+s,+a),r=printFormattedDate(e,"N");return this.low&&+i<+this.low||this.high&&+i>+this.high||i in n||this.disabledDays[r-1]?!1:!0},datePicker.prototype.updateStatus=function(e){for(;this.statusBar.firstChild;)this.statusBar.removeChild(this.statusBar.firstChild);if(e&&-1!=this.statusFormat.search(/-S|S-/)&&-1!=e.search(/([0-9]{1,2})(st|nd|rd|th)/)){e=e.replace(/([0-9]{1,2})(st|nd|rd|th)/,"$1<sup>$2</sup>").split(/<sup>|<\/sup>/);for(var t,a=document.createDocumentFragment(),s=0;t=e[s];s++)if(/^(st|nd|rd|th)$/.test(t)){var i=document.createElement("sup");i.appendChild(document.createTextNode(t)),a.appendChild(i)}else a.appendChild(document.createTextNode(t));this.statusBar.appendChild(a)}else this.statusBar.appendChild(document.createTextNode(e?e:getTitleTranslation(9)))},datePicker.prototype.setDateFromInput=function(){this.dateSet=null;var e,t=this.getElem(),a=!1;if(t&&-1!=t.tagName.search(/select|input/i)){if(this.splitDate||""===t.value.replace(/\s/g,"")){if(this.splitDate){var s=document.getElementById(this.id+splitAppend[1]),i=document.getElementById(this.id+splitAppend[0]),n=parseInt("input"==s.tagName.toLowerCase()?s.value:s.options[s.selectedIndex||0].value,10),r=parseInt("input"==i.tagName.toLowerCase()?i.value:i.options[i.selectedIndex||0].value,10),d=parseInt("input"==t.tagName.toLowerCase()?t.value:t.options[t.selectedIndex||0].value,10);/\d\d\d\d/.test(d)&&/^(0?[1-9]|1[012])$/.test(n)&&/^(0?[1-9]|[12][0-9]|3[01])$/.test(r)?+r>daysInMonth(+n-1,+d)?(a=!0,r=daysInMonth(+n-1,+d),e=new Date(d,n-1,r)):e=new Date(d,n-1,r):e=!1}}else for(var o,l=formatMasks.concat([this.format]).reverse(),c=0;o=l[c];c++)if(e=parseDateString(t.value,o)){a=!0;break}if(!e||isNaN(e))return this.date=new Date,this.date.setHours(5),void this.outOfRange();e.setHours(5),this.date=new Date(e),this.outOfRange(),e.getTime()==this.date.getTime()&&this.canDateBeSelected(this.date)&&(this.dateSet=new Date(this.date)),a&&this.returnFormattedDate(!0)}},datePicker.prototype.setSelectIndex=function(e,t){for(var a=e.options.length-1;a>=0;a--)if(e.options[a].value==+t)return void(e.selectedIndex=a)},datePicker.prototype.returnFormattedDate=function(e){var t=this.getElem();if(t&&null!=this.dateSet){e=!!e;var a=pad(this.date.getDate()),s=pad(this.date.getMonth()+1),i=this.date.getFullYear(),n=(this.getDisabledDates(+i,+s),(this.date.getDay()+6)%7);if(!(this.disabledDays[n]||String(i)+s+a in this.disabledDates)){if(this.splitDate){var r=document.getElementById(this.id+splitAppend[0]),d=document.getElementById(this.id+splitAppend[1]),o=t.value,l=d.value,c=r.value;if(+o==+i&&+l==+s&&+c==+a)return;"input"==r.tagName.toLowerCase()?r.value=a:this.setSelectIndex(r,a),"input"==d.tagName.toLowerCase()?d.value=s:this.setSelectIndex(d,s),"input"==t.tagName.toLowerCase()?t.value=i:this.setSelectIndex(t,i)}else if("input"==t.tagName.toLowerCase()){var h=t.value,u=printFormattedDate(this.date,this.format,returnLocaleDate);if(h==u)return;t.value=u}this.staticPos&&(this.noFocus=!0,this.updateTable(),this.noFocus=!1),this.fullCreate&&(t.type&&"hidden"!=t.type&&!e&&t.focus(),this.callback("dateselect",{id:this.id,date:this.dateSet,dd:a,mm:s,yyyy:i}))}}},datePicker.prototype.disableDatePicker=function(){if(!this.disabled){if(this.staticPos)this.removeFocusEvents(),this.noFocus=!0,this.div.className=this.div.className.replace(/dp-disabled/,"")+" dp-disabled",this.table.onmouseover=this.table.onclick=this.table.onmouseout=this.table.onmousedown=null,removeEvent(document,"mousedown",this.onmousedown),removeEvent(document,"mouseup",this.clearTimer);else{this.visible&&this.hide();var e=document.getElementById("fd-but-"+this.id);e&&(e.className=e.className.replace(/dp-disabled/,"")+" dp-disabled",setARIAProperty(e,"disabled",!0),e.onkeydown=e.onclick=function(){return!1},e.setAttribute("tabIndex","-1"),e.tabIndex=-1)}clearTimeout(this.timer),this.disabled=!0}},datePicker.prototype.enableDatePicker=function(){if(this.disabled){if(this.staticPos)this.removeOldFocus(),this.noFocus=!0,this.addSpans=!0,this.updateTable(),this.div.className=this.div.className.replace(/dp-disabled/,""),this.disabled=!1,this.table.onmouseover=this.onmouseover,this.table.onmouseout=this.onmouseout,this.table.onclick=this.onclick,this.table.onmousedown=this.onmousedown;else{var e=document.getElementById("fd-but-"+this.id);e&&(e.className=e.className.replace(/dp-disabled/,""),setARIAProperty(e,"disabled",!1),this.addButtonEvents(e))}this.disabled=!1}},datePicker.prototype.disableTodayButton=function(){var e=new Date;this.butToday.className=this.butToday.className.replace("fd-disabled",""),(this.outOfRange(e)||this.date.getDate()==e.getDate()&&this.date.getMonth()==e.getMonth()&&this.date.getFullYear()==e.getFullYear())&&(this.butToday.className+=" fd-disabled")},datePicker.prototype.updateTableHeaders=function(){for(var e,t,a=this.showWeeks?8:7,s=this.showWeeks?1:0,i=s;a>i;i++){if(e=(this.firstDayOfWeek+(i-s))%7,this.ths[i].title=getDayTranslation(e,!1),i>s){for(t=this.ths[i].getElementsByTagName("span")[0];t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(getDayTranslation(e,!0))),t.title=this.ths[i].title,t.className=t.className.replace(/day-([0-6])/,"")+" day-"+e,t=null}else{for(;this.ths[i].firstChild;)this.ths[i].removeChild(this.ths[i].firstChild);this.ths[i].appendChild(document.createTextNode(getDayTranslation(e,!0)))}this.ths[i].className=this.ths[i].className.replace(/date-picker-highlight/g,""),this.highlightDays[e]&&(this.ths[i].className+=" date-picker-highlight")}this.created&&this.updateTable()},datePicker.prototype.callback=function(e,t){if(!(e&&e in this.callbacks))return!1;for(var a=!1,s=0;s<this.callbacks[e].length;s++)if(a=this.callbacks[e][s](t||this.id),!a)return!1;return a},datePicker.prototype.showHideButtons=function(e){var t=e.getMonth(),a=e.getFullYear();this.butPrevYear.className=this.butPrevYear.className.replace("fd-disabled",""),this.outOfRange(new Date(a-1,t,daysInMonth(+t,a-1)))&&(this.butPrevYear.className+=" fd-disabled",-1==this.yearInc&&this.stopTimer()),this.butPrevMonth.className=this.butPrevMonth.className.replace("fd-disabled",""),this.outOfRange(new Date(a,+t-1,daysInMonth(+t-1,a)))&&(this.butPrevMonth.className+=" fd-disabled",-1==this.monthInc&&this.stopTimer()),this.butNextYear.className=this.butNextYear.className.replace("fd-disabled",""),this.outOfRange(new Date(a+1,+t,1))&&(this.butNextYear.className+=" fd-disabled",1==this.yearInc&&this.stopTimer()),this.butNextMonth.className=this.butNextMonth.className.replace("fd-disabled",""),this.outOfRange(new Date(a,+t+1,1))&&(this.butNextMonth.className+=" fd-disabled",1==this.monthInc&&this.stopTimer())};var localeDefaults={fullMonths:["January","February","March","April","May","June","July","August","September","October","November","December"],monthAbbrs:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],fullDays:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],dayAbbrs:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],titles:["Previous month","Next month","Previous year","Next year","Today","Show Calendar","wk","Week [[%0%]] of [[%1%]]","Week","Select a date","Click & Drag to move","Display “[[%0%]]” first","Go to Today’s date","Disabled date"],firstDayOfWeek:0,imported:!1},grepRangeLimits=function(e){for(var t=[],a=0;a<e.options.length;a++)-1!=e.options[a].value.search(/^\d\d\d\d$/)&&((!t[0]||Number(e.options[a].value)<t[0])&&(t[0]=Number(e.options[a].value)),(!t[1]||Number(e.options[a].value)>t[1])&&(t[1]=Number(e.options[a].value)));return t},joinNodeLists=function(){if(!arguments.length)return[];for(var e=[],t=0;t<arguments.length;t++)for(var a,s=0;a=arguments[t][s];s++)e[e.length]=a;return e},cleanUp=function(){var e;for(e in datePickers)document.getElementById(datePickers[e].id)||(datePickers[e].destroy(),datePickers[e]=null,delete datePickers[e])},hideAll=function(e){var t;for(t in datePickers)!datePickers[t].created||e&&e==datePickers[t].id||datePickers[t].hide()},hideDatePicker=function(e){if(e in datePickers){if(!datePickers[e].created||datePickers[e].staticPos)return;datePickers[e].hide()}},showDatePicker=function(e,t){return e in datePickers?(datePickers[e].show(t),!0):!1},destroy=function(){for(dp in datePickers)datePickers[dp].destroy(),datePickers[dp]=null,delete datePickers[dp];datePickers=null,removeEvent(window,"load",datePickerController.create),removeEvent(window,"unload",datePickerController.destroy)},destroySingleDatePicker=function(e){e&&e in datePickers&&(datePickers[e].destroy(),datePickers[e]=null,delete datePickers[e])},getTitleTranslation=function(e,t){if(t=t||[],localeImport.titles.length>e){var a=localeImport.titles[e];if(t&&t.length)for(var s=0;s<t.length;s++)a=a.replace("[[%"+s+"%]]",t[s]);return a.replace(/[[%(\d)%]]/g,"")}return""},getDayTranslation=function(e,t){var a=localeImport[t?"dayAbbrs":"fullDays"];return a.length&&a.length>e?a[e]:""},getMonthTranslation=function(e,t){var a=localeImport[t?"monthAbbrs":"fullMonths"];return a.length&&a.length>e?a[e]:""},daysInMonth=function(e,t){return e=(e+12)%12,0!=t%4||0==t%100&&0!=t%400||1!=e?[31,28,31,30,31,30,31,31,30,31,30,31][e]:29},getWeeksInYear=function(Y){if(Y in weeksInYearCache)return weeksInYearCache[Y];var X1,X2;with(X1=new Date(Y,0,4))setDate(getDate()-(6+getDay())%7);with(X2=new Date(Y,11,28))setDate(getDate()+(7-getDay())%7);return weeksInYearCache[Y]=Math.round((X2-X1)/6048e5),weeksInYearCache[Y]},parseRangeFromString=function(e){if(!e)return"";var t=-1!=e.search(/^range-low-/);if(e=e.replace(/range-(low|high)-/,""),-1!=e.search(/^(\d\d\d\d)(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01])$/))return e;var a=new Date;if(-1!=e.search(/^today$/))return a.getFullYear()+pad(a.getMonth()+1)+pad(a.getDate());var s=/^(\d)-(day|week|month|year)$/;if(-1!=e.search(s)){var i=e.match(s),n={day:0,week:0,month:0,year:0};return n[i[2]]=t?-+i[1]:+i[1],a.setFullYear(a.getFullYear()+ +n.year),a.setMonth(a.getMonth()+ +n.month),a.setDate(a.getDate()+ +n.day+7*+n.week),!a||isNaN(a)?"":a.getFullYear()+pad(a.getMonth()+1)+pad(a.getDate())}return""},getWeekNumber=function(e,t,a){var a=new Date(e,t,a,0,0,0),s=a.getDay();a.setDate(a.getDate()-(s+6)%7+3);var i=a.valueOf();return a.setMonth(0),a.setDate(4),Math.round((i-a.valueOf())/6048e5)+1},printFormattedDate=function(e,t,a){if(!e||isNaN(e))return"";for(var s,i=t.split("-"),n=[],r=e.getDate(),d=e.getDay(),o=e.getMonth(),l=e.getFullYear(),c={sp:" ",dt:".",sl:"/",ds:"-",cc:",",d:pad(r),D:a?localeImport.dayAbbrs[0==d?6:d-1]:localeDefaults.dayAbbrs[0==d?6:d-1],l:a?localeImport.fullDays[0==d?6:d-1]:localeDefaults.fullDays[0==d?6:d-1],j:r,N:0==d?7:d,w:d,W:getWeekNumber(e),M:a?localeImport.monthAbbrs[o]:localeDefaults.monthAbbrs[o],F:a?localeImport.fullMonths[o]:localeDefaults.fullMonths[o],m:pad(o+1),n:o+1,t:daysInMonth(o+1,l),Y:l,o:l,y:String(l).substr(2,2),S:["th","st","nd","rd"][r%10>3?0:(r%100-r%10!=10)*r%10]},h=0;s=i[h];h++)n.push(s in c?c[s]:"");return n.join("")},parseDateString=function(e,t){var a=!1,s=!1,i=!1,n=new Date,r=t.replace(/-sp(-sp)+/g,"-sp").split("-"),d={dt:".",sl:"/",ds:"-",cc:","};e:for(var o,c=0;o=r[c];c++){if(0==e.length)return!1;switch(o){case"sp":if(-1!=e.charAt(0).search(/\s/)){for(;-1!=e.charAt(0).search(/\s/);)e=e.substr(1);break}return"";case"dt":case"sl":case"ds":case"cc":if(e.charAt(0)==d[o]){e=e.substr(1);break}return"";case"d":case"j":if(-1!=e.search(/^(3[01]|[12][0-9]|0?[1-9])/)){a=+e.match(/^(3[01]|[12][0-9]|0?[1-9])/)[0],e=e.substr(e.match(/^(3[01]|[12][0-9]|0?[1-9])/)[0].length);break}return"";case"D":case"l":l="D"==o?localeDefaults.dayAbbrs:localeDefaults.fullDays;for(var h=0;7>h;h++)if(new RegExp("^"+l[h],"i").test(e)){e=e.substr(l[h].length);continue e}return"";case"N":case"w":if(-1!=e.search("N"==o?/^([1-7])/:/^([0-6])/)){e=e.substr(1);break}return"";case"S":if(-1!=e.search(/^(st|nd|rd|th)/i)){e=e.substr(2);break}return"";case"z":if(-1!=e.search(/^([0-9]|[1-9][0-9]|[12][0-9]{2}|3[0-5][0-9]|36[0-5])/)){e=e.substr(e.match(/^([0-9]|[1-9][0-9]|[12][0-9]{2}|3[0-5][0-9]|36[0-5])/)[0].length);break}return"";case"W":if(-1!=e.search(/^([1-9]|[1234[0-9]|5[0-3])/)){e=e.substr(e.match(/^([1-9]|[1234[0-9]|5[0-3])/)[0].length);break}return"";case"M":case"F":l=localeDefaults.fullMonths.concat(localeDefaults.monthAbbrs);for(var h=0;24>h;h++)if(-1!=e.search(new RegExp("^"+l[h],"i"))){e=e.substr(l[h].length),s=(h+12)%12;continue e}return"";case"m":case"n":if(l=/^(1[012]|0?[1-9])/,-1!=e.search(l)){s=+e.match(l)[0]-1,e=e.substr(e.match(l)[0].length);break}return"";case"t":if(-1!=e.search(/2[89]|3[01]/)){e=e.substr(2);break}return"";case"Y":case"o":if(-1!=e.search(/^(\d{4})/)){i=e.substr(0,4),e=e.substr(4);break}return"";case"y":if(-1!=e.search(/^(\d{4})/)){i=e.substr(0,4),e=e.substr(4);break}if(-1!=e.search(/^(0[0-9]|[1-9][0-9])/)){i=e.substr(0,2),i=50>+i?"20"+String(i):"19"+String(i),e=e.substr(2);break}return"";default:return""}}a=a===!1?n.getDate():a,s=s===!1?n.getMonth()-1:s,i=i===!1?n.getFullYear():i;var u=new Date(i,s,a);return isNaN(u)?"":u},repositionDatePickers=function(e){for(dp in datePickers)datePickers[dp].created&&!datePickers[dp].staticPos&&(datePickers[dp].staticPos||datePickers[dp].dragDisabled)&&datePickers[dp].reposition()},findLabelForElement=function(e){var t;if(e.parentNode&&"label"==e.parentNode.tagName.toLowerCase())lebel=e.parentNode;else for(var a=document.getElementsByTagName("label"),s=0;s<a.length;s++)if(a[s].htmlFor&&a[s].htmlFor==e.id||a[s].getAttribute("for")==e.id){t=a[s];break}return t&&!t.id&&(t.id=e.id+"_label"),t},addDatePicker=function(e){if(!e.id)throw"A datePicker requires an associated element with an id attribute";if(!(e.id in datePickers)){var t=document.getElementById(e.id);if(!t)throw"Cannot locate a datePicker's associated form element with an id of: "+e.id;if(-1==t.tagName.search(/select|input/i)){if(!("callbacks"in e&&"dateselect"in e.callbacks))throw"A 'dateselect' callback function is required for datePickers not associated with a form element";e.staticPos=!0,e.splitDate=!1,e.hideInput=!1,e.noFadeEffect=!0,e.dragDisabled=!0,e.positioned=!1}else e.staticPos?(e.noFadeEffect=!0,e.dragDisabled=!0):e.hideInput=!1;datePickers[e.id]=new datePicker(e)}},parseCallbacks=function(e){if(null==e)return{};for(var t,a,s,i,n,r={},d=0;n=e[d];d++){a=n.match(/(cb_(dateselect|redraw|create)_)([^\s|$]+)/i)[1].replace(/^cb_/i,"").replace(/_$/,""),n=n.replace(/cb_(dateselect|redraw|create)_/i,"").replace(/-/g,".");try{if(-1!=n.indexOf(".")){s=n.split("."),i=window;for(var o,l=0;o=i[s[l]];l++)o instanceof Function?!function(){var e=o;t=function(t){e.apply(i,[t])}}():i=o}else t=window[n];if(!(t instanceof Function))continue;a in r||(r[a]=[]),r[a][r[a].length]=t}catch(c){}}return r},isVisible=function(e){return e&&e in datePickers?datePickers[e].visible:!1},create=function(e){if("undefined"!=typeof document.createElement&&"undefined"!=typeof document.documentElement&&"number"==typeof document.documentElement.offsetWidth){"object"!=typeof fdLocale||localeImport?localeImport||(localeImport=localeDefaults):localeImport={titles:fdLocale.titles,fullMonths:fdLocale.fullMonths,monthAbbrs:fdLocale.monthAbbrs,fullDays:fdLocale.fullDays,dayAbbrs:fdLocale.dayAbbrs,firstDayOfWeek:"firstDayOfWeek"in fdLocale?fdLocale.firstDayOfWeek:0,imported:!0};for(var t,a,s,i,n,r,d,o,l=e&&e.tagName?[e]:joinNodeLists(document.getElementsByTagName("input"),document.getElementsByTagName("select")),c=/disable-days-([1-7]){1,6}/g,h=/highlight-days-([1-7]{1,7})/,u=/range-low-(((\d\d\d\d)(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01]))|((\d)-(day|week|month|year))|(today))/,p=/range-high-(((\d\d\d\d)(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01]))|((\d)-(day|week|month|year))|(today))/,m=/dateformat(-((sp|dt|sl|ds|cc)|([d|D|l|j|N|w|S|W|M|F|m|n|t|Y|o|y|O|p])))+/,f=/statusformat(-((sp|dt|sl|ds|cc)|([d|D|l|j|N|w|S|W|M|F|m|n|t|Y|o|y|O|p])))+/,g=/disable((-(\d\d\d\d)(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01])){2}|(-((\d\d\d\d)|(xxxx))((0[1-9]|1[012])|(xx))(0[1-9]|[12][0-9]|3[01])))/g,b=/enable((-(\d\d\d\d)(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01])){2}|(-((\d\d\d\d)|(xxxx))((0[1-9]|1[012])|(xx))(0[1-9]|[12][0-9]|3[01])))/g,y=/((cb_(dateselect|redraw|create)_)([^\s|$]+))/gi,v=/display-inline-([^\s|$]+)/i,k=/button-([^\s|$]+)/i,D=0;o=l[D];D++)if(o.className&&(-1!=o.className.search(m)||-1!=o.className.search(/split-date/))&&("input"==o.tagName.toLowerCase()&&("text"==o.type||"hidden"==o.type)||"select"==o.tagName.toLowerCase())){if(o.id&&o.id in datePickers){datePickers[o.id].staticPos?document.getElementById("fd-"+o.id)?e&&(datePickers[o.id].setDateFromInput(),datePickers[o.id].updateTable()):(datePickers[o.id].created=!1,datePickers[o.id].create()):datePickers[o.id].createButton();continue}if(o.id||(o.id="fdDatePickerInput-"+uniqueId++),n={id:o.id,low:"",high:"",format:"d-sl-m-sl-Y",statusFormat:"",highlightDays:[0,0,0,0,0,1,1],disabledDays:[0,0,0,0,0,0,0],disabledDates:{},enabledDates:{},noFadeEffect:-1!=o.className.search(/no-animation/i),staticPos:-1!=o.className.search(/display-inline/i),hideInput:-1!=o.className.search(/hide-input/i),noToday:-1!=o.className.search(/no-today-button/i),showWeeks:-1!=o.className.search(/show-week/i),dragDisabled:nodrag?!0:-1!=o.className.search(/disable-drag/i),positioned:!1,firstDayOfWeek:localeImport.firstDayOfWeek,fillGrid:-1!=o.className.search(/fill-grid/i),constrainSelection:-1!=o.className.search(/fill-grid-no-select/i),callbacks:parseCallbacks(o.className.match(y)),buttonWrapper:"",labelledBy:findLabelForElement(o)},n.staticPos&&-1!=o.className.search(v)&&(n.positioned=o.className.match(v)[1]),n.staticPos||-1==o.className.search(k)||(n.buttonWrapper=o.className.match(k)[1]),n.staticPos||(n.finalOpacity=-1!=o.className.search(/opacity-([1-9]{1}[0-9]{1})/i)?o.className.match(/opacity-([1-9]{1}[0-9]{1})/i)[1]:90),r=o.className.match(g))for(i=0;i<r.length;i++)d=r[i].replace(/xxxx/,"****").replace(/xx/,"**").replace("disable-","").split("-"),n.disabledDates[d[0]]=d.length&&2==d.length?d[1]:1;if(r=o.className.match(b))for(i=0;i<r.length;i++)d=r[i].replace(/xxxx/,"****").replace(/xx/,"**").replace("enable-","").split("-"),n.enabledDates[d[0]]=d.length&&2==d.length?d[1]:1;if(n.splitDate=-1!=o.className.search(/split-date/)&&document.getElementById(o.id+splitAppend[0])&&document.getElementById(o.id+splitAppend[1])&&-1!=document.getElementById(o.id+splitAppend[0]).tagName.search(/input|select/i)&&-1!=document.getElementById(o.id+splitAppend[1]).tagName.search(/input|select/i),n.splitDate||-1==o.className.search(m)||(n.format=o.className.match(m)[0].replace("dateformat-","")),-1!=o.className.search(f)&&(n.statusFormat=o.className.match(f)[0].replace("statusformat-","")),-1!=o.className.search(h))for(a=o.className.match(h)[0].replace(/highlight-days-/,""),n.highlightDays=[0,0,0,0,0,0,0],s=0;s<a.length;s++)n.highlightDays[a.charAt(s)-1]=1;if(-1!=o.className.search(c))for(a=o.className.match(c)[0].replace(/disable-days-/,""),n.disabledDays=[0,0,0,0,0,0,0],s=0;s<a.length;s++)n.disabledDays[a.charAt(s)-1]=1;-1!=o.className.search(u)&&(n.low=parseRangeFromString(o.className.match(u)[0])),-1!=o.className.search(p)&&(n.high=parseRangeFromString(o.className.match(p)[0])),-1!=o.tagName.search(/select/i)&&(t=grepRangeLimits(o),n.low=n.low?t[0]+String(n.low).substr(4,4):t[0]+"0101",n.high=n.high?t[1]+String(n.high).substr(4,4):t[1]+"1231"),addDatePicker(n)}}};return addEvent(window,"load",create),addEvent(window,"unload",destroy),addEvent(window,"resize",repositionDatePickers),{addEvent:function(e,t,a){return addEvent(e,t,a)},removeEvent:function(e,t,a){return removeEvent(e,t,a)},stopEvent:function(e){return stopEvent(e)},show:function(e){return showDatePicker(e,!1)},hide:function(e){return hideDatePicker(e)},create:function(e){create(e)},destroyDatePicker:function(e){destroySingleDatePicker(e)},cleanUp:function(){cleanUp()},repositionDatePickers:function(){repositionDatePickers()},printFormattedDate:function(e,t,a){return printFormattedDate(e,t,a)},setDateFromInput:function(e){return e&&e in datePickers&&datePickers[e].created?void datePickers[e].setDateFromInput():!1},setRangeLow:function(e,t){return e&&e in datePickers?void datePickers[e].setRangeLow(t):!1},setRangeHigh:function(e,t){return e&&e in datePickers?void datePickers[e].setRangeHigh(t):!1},parseDateString:function(e,t){return parseDateString(e,t)},setGlobalVars:function(e){affectJSON(e)},dateValidForSelection:function(e,t){return e&&e in datePickers?void datePickers[e].canDateBeSelected(t):!1},addDisabledDates:function(e,t){return e&&e in datePickers?void datePickers[e].addDisabledDates(t):!1},setDisabledDates:function(e,t){return e&&e in datePickers?void datePickers[e].setDisabledDates(t):!1},disable:function(e){return e&&e in datePickers?void datePickers[e].disableDatePicker():!1},enable:function(e){return e&&e in datePickers?void datePickers[e].enableDatePicker():!1}}}();